(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{518:function(a,t,s){"use strict";s.r(t);var n=s(42),e=Object(n.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"スクリプト表記"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#スクリプト表記"}},[a._v("#")]),a._v(" スクリプト表記")]),a._v(" "),s("p",[a._v("naninovelスクリプトを作成するときは、中かっこ "),s("code",[a._v("{}")]),a._v("を使用して、式の構成をコマンドパラメーター値と一般テキスト行に挿入できます:")]),a._v(" "),s("div",{staticClass:"language-nani extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nani"}},[s("code",[s("span",{pre:!0,attrs:{class:"token generic-text punctuation"}},[a._v("One plus two equals "),s("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{1 + 2}")]),a._v(".")]),a._v("\n")])])]),s("p",[a._v('— スクリプトを実行すると、"One plus two equals 3" を表示します。')]),a._v(" "),s("p",[s("a",{attrs:{href:"https://docs.unity3d.com/ScriptReference/Mathf.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("UnityEngine.Mathf"),s("OutboundLink")],1),a._v("および"),s("a",{attrs:{href:"https://docs.microsoft.com/en-us/dotnet/api/system.math#methods",target:"_blank",rel:"noopener noreferrer"}},[a._v("System.Math"),s("OutboundLink")],1),a._v(" ネームスペースの数学関数に加えて、数式、論理演算子が使えます:")]),a._v(" "),s("div",{staticClass:"language-nani extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nani"}},[s("code",[s("span",{pre:!0,attrs:{class:"token command function"}},[s("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@char")]),s("span",{pre:!0,attrs:{class:"token command-params"}},[s("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),s("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("Kohaku")]),s("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" scale:")])]),s("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{Pow(Cosh(33.5), 3) % Log(0.5)}")])]),a._v("\n")])])]),s("p",[a._v('— これは IDが "Kohaku" のキャラクターを、33.5度の双曲線コサインを3乗し、自然対数0.5で割ったもので拡大します:')]),a._v(" "),s("p",[a._v("式はコマンドの実行時に評価され、式内で "),s("RouterLink",{attrs:{to:"/ja/guide/custom-variables.html"}},[a._v("カスタム変数")]),a._v(" を使用できます。")],1),a._v(" "),s("div",{staticClass:"language-nani extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nani"}},[s("code",[s("span",{pre:!0,attrs:{class:"token command function"}},[s("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@input")]),s("span",{pre:!0,attrs:{class:"token command-params"}},[s("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),s("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("color")]),s("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" summary:")]),s("span",{pre:!0,attrs:{class:"token quoted-string operator"}},[a._v('"What\'s your favorite color?"')])])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command function"}},[s("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@stop")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token generic-text punctuation"}},[s("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{color}")]),a._v(", huh? "),s("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v('{ color == "orange" ? "Mine too!" : "I see..."}')])]),a._v("\n")])])]),s("p",[a._v("— 上記はプレイヤーに好きな色を入力させる入力UIを表示し、カスタム変数 "),s("code",[a._v("color")]),a._v(' に割り当てます。そして入力された色を表示し、もし "orange" なら "Mine too!" それ以外なら "I see..." と続けます。')]),a._v(" "),s("p",[a._v("プレーンテキスト値と変数名を区別するには、値を二重引用符 "),s("code",[a._v('"')]),a._v(" で囲みます:")]),a._v(" "),s("div",{staticClass:"language-nani extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nani"}},[s("code",[s("span",{pre:!0,attrs:{class:"token generic-text punctuation"}},[a._v("This is just a plain text: "),s("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v('{ "score" }')]),a._v(".")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token generic-text punctuation"}},[a._v('And this is the value of "score" variable: '),s("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{ score }")]),a._v(".")]),a._v("\n")])])]),s("p",[a._v("式に二重引用符を含める場合は、 "),s("strong",[a._v("2回")]),a._v(" エスケープします:")]),a._v(" "),s("div",{staticClass:"language-nani extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nani"}},[s("code",[s("span",{pre:!0,attrs:{class:"token generic-text punctuation"}},[a._v("Saying "),s("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v('{ \\\\"Stop the car\\\\" }')]),a._v(" was a mistake.")]),a._v("\n")])])]),s("p",[s("a",{attrs:{href:"/ja/api/#set",target:"_blank"}},[s("code",[a._v("@set")])]),a._v(" と "),s("a",{attrs:{href:"/ja/api/#if",target:"_blank"}},[s("code",[a._v("@if")])]),a._v(" コマンド(他のコマンドの "),s("code",[a._v("set")]),a._v(" と "),s("code",[a._v("if")]),a._v(" パラメーターも同様)の中で使われる式は、中かっこは必要ありません:")]),a._v(" "),s("div",{staticClass:"language-nani extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nani"}},[s("code",[s("span",{pre:!0,attrs:{class:"token command function"}},[s("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@set")]),s("span",{pre:!0,attrs:{class:"token command-params"}},[s("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),s("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("randomScore=Random(-100,100)")])])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command function"}},[s("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@goto")]),s("span",{pre:!0,attrs:{class:"token command-params"}},[s("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),s("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("EpicLabel")]),s("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" if:")]),s("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("Abs(randomScore)>=50")])])]),a._v("\n")])])]),s("p",[a._v("ただし、他のすべてのパラメーター値と同様に、式内でスペースを使用する場合は、二重引用符で囲む必要があります:")]),a._v(" "),s("div",{staticClass:"language-nani extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nani"}},[s("code",[s("span",{pre:!0,attrs:{class:"token command function"}},[s("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@set")]),s("span",{pre:!0,attrs:{class:"token command-params"}},[s("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),s("span",{pre:!0,attrs:{class:"token quoted-string operator"}},[a._v('"randomScore = Random(-100, 100)"')])])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token command function"}},[s("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@goto")]),s("span",{pre:!0,attrs:{class:"token command-params"}},[s("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),s("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("EpicLabel")]),s("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" if:")]),s("span",{pre:!0,attrs:{class:"token quoted-string operator"}},[a._v('"Abs(randomScore) >= 50"')])])]),a._v("\n")])])]),s("p",[a._v("一般テキスト内に中かっこを表示し、式の開始/終了リテラルとして認識されないようにするには、中かっこをバックスラッシュでエスケープします。例:")]),a._v(" "),s("div",{staticClass:"language-nani extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nani"}},[s("code",[s("span",{pre:!0,attrs:{class:"token generic-text punctuation"}},[a._v("Some text "),s("span",{pre:!0,attrs:{class:"token escaped-char"}},[a._v("\\{")]),a._v(" text inside braces "),s("span",{pre:!0,attrs:{class:"token escaped-char"}},[a._v("\\}")])]),a._v("\n")])])]),s("p",[a._v('— 上記はゲーム内に "Some text { text inside braces }" と表示します。')]),a._v(" "),s("h2",{attrs:{id:"関数式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#関数式"}},[a._v("#")]),a._v(" 関数式")]),a._v(" "),s("p",[a._v("次の関数は、スクリプト式内でも使用できます。")]),a._v(" "),s("div",{staticClass:"config-table"},[s("table",[s("thead",[s("tr",[s("th",[a._v("Signature")]),a._v(" "),s("th",[a._v("説明")]),a._v(" "),s("th",[a._v("使用例")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("Random ("),s("em",[a._v("System.Double")]),a._v(" min, "),s("em",[a._v("System.Double")]),a._v(" max)")]),a._v(" "),s("td",[a._v("最小[引数]と最大[引数]の間で、ランダムな浮動小数点の数値を返します。")]),a._v(" "),s("td",[s("code",[a._v("Random(0.1, 0.85)")])])]),a._v(" "),s("tr",[s("td",[a._v("Random ("),s("em",[a._v("System.Int32")]),a._v(" min, "),s("em",[a._v("System.Int32")]),a._v(" max)")]),a._v(" "),s("td",[a._v("最小[引数]と最大[引数]の間で、ランダムな整数を返します、")]),a._v(" "),s("td",[s("code",[a._v("Random(0, 100)")])])]),a._v(" "),s("tr",[s("td",[a._v("Random ("),s("em",[a._v("System.String[]")]),a._v(" args)")]),a._v(" "),s("td",[a._v("指定した文字列の中から1つを返します。")]),a._v(" "),s("td",[s("code",[a._v('Random("Foo", "Bar", "Foobar")')])])]),a._v(" "),s("tr",[s("td",[a._v("CalculateProgress ()")]),a._v(" "),s("td",[a._v("0.0から1.0の範囲の浮動小数点の数値を返します。Naninovel で使用可能な全てのスクリプトコマンドの合計に対して、これまでに実行したユニークなコマンド数を表します。1.0は、プレイヤーが全てのコンテンツを "),s("code",[a._v("読み通した")]),a._v(" か "),s("code",[a._v("見た")]),a._v(" ということになります。この機能を使う前に、スクリプトコンフィグメニューで必ず "),s("code",[a._v("Count Total Commands")]),a._v(" を有効にして下さい。")]),a._v(" "),s("td",[s("code",[a._v("CalculateProgress()")])])])])])]),a._v(" "),s("h2",{attrs:{id:"カスタム関数の追加"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#カスタム関数の追加"}},[a._v("#")]),a._v(" カスタム関数の追加")]),a._v(" "),s("p",[a._v("静的 C# クラスに "),s("code",[a._v("ExpressionFunctions")]),a._v(" 属性を割り当てることにより、カスタム式関数を追加できます。 互換性のあるシグネチャを持つこのクラスのすべてのパブリックメソッドは、スクリプト式で自動的に使用できるようになります。")]),a._v(" "),s("p",[a._v("互換性のあるシグネチャは、"),s("a",{attrs:{href:"https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/value-types#simple-types",target:"_blank",rel:"noopener noreferrer"}},[a._v("simple"),s("OutboundLink")],1),a._v(" 型と文字列型を受け取り、返します。"),s("code",[a._v("params")]),a._v(" キーワードが付いたこのタイプの配列も同様です。")]),a._v(" "),s("div",{staticClass:"language-csharp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token attribute"}},[s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Naninovel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("ExpressionFunctions")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CustomFunctions")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// すべての文字を小文字に変換して、指定した文字列を返します。")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token return-type class-name"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("string")])]),a._v(" ToLower "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("string")])]),a._v(" content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ToLower")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 指定した数値の合計を返します。")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token return-type class-name"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")])]),a._v(" Add "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")])]),a._v(" a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")])]),a._v(" b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" a "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 指定した文字列の1つからランダムに選択された文字列を返します。")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token return-type class-name"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("string")])]),a._v(" Random "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("params")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("args "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("null")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("||")]),a._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Length "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("var")])]),a._v(" randomIndex "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" UnityEngine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("Range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("randomIndex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("div",{staticClass:"custom-block example"},[s("p",{staticClass:"custom-block-title"},[a._v("例")]),a._v(" "),s("p",[a._v("カスタム式関数を追加して、アイテムがインベントリに存在するかどうかを確認する別の例は "),s("a",{attrs:{href:"https://github.com/Naninovel/Inventory",target:"_blank",rel:"noopener noreferrer"}},[a._v("GitHubのインベントリサンプルプロジェクト"),s("OutboundLink")],1),a._v(" にあります。。")]),a._v(" "),s("p",[a._v("具体的には、カスタム関数は "),s("a",{attrs:{href:"https://github.com/Naninovel/Inventory/blob/master/Assets/NaninovelInventory/Runtime/InventoryFunctions.cs",target:"_blank",rel:"noopener noreferrer"}},[a._v("InventoryFunctions.cs"),s("OutboundLink")],1),a._v(" ランタイムスクリプトで実装されています。")])])])}),[],!1,null,null,null);t.default=e.exports}}]);