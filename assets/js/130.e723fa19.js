(window.webpackJsonp=window.webpackJsonp||[]).push([[130],{386:function(t,a,s){"use strict";s.r(a);var e=s(42),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"управnяемый-текст"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#управnяемый-текст"}},[t._v("#")]),t._v(" Управляемый текст")]),t._v(" "),s("p",[t._v("Функция управляемого текста позволяет управлять (с помощью замены) различными текстовыми элементами, используемыми в Naninovel, такими как UI в игре и именами персонажей, используя локализуемые документы.")]),t._v(" "),s("p",[t._v("Для создания управляемого текстового документа, используйте инструмент для управляемого текста, доступный через контекстное меню "),s("code",[t._v("Naninovel -> Tools -> Managed Text")]),t._v(".")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://i.gyazo.com/200680de85848f04a2eb51b063295c51.png",alt:"Инструмент для управляемого текста"}})]),t._v(" "),s("p",[t._v('Используя кнопку "Select", выберите путь для хранения управляемых текстовых документов (по умолчанию это '),s("code",[t._v("Resources/Naninovel/Text")]),t._v(') и нажмите кнопку "Generate" для создания документов.')]),t._v(" "),s("p",[t._v("Вы также можете создать пользовательский управляемый текстовый документ с помощью контекстного меню ассета "),s("code",[t._v("Create -> Naninovel -> Managed Text")]),t._v(".")]),t._v(" "),s("p",[t._v("Каждая строка в управляемом текстовом документе представляет собой выражение в следующем формате: "),s("em",[t._v("Path")]),t._v(": "),s("em",[t._v("Value")]),t._v(", где "),s("em",[t._v("Path")]),t._v(" – путь к текстовой переменной, а "),s("em",[t._v("Value")]),t._v(' – значение этой переменной. Например, вот изначальное содержимое документа "DefaultUI", который содержит записи для встроенного UI:')]),t._v(" "),s("p",[s("img",{attrs:{src:"https://i.gyazo.com/ce57c700b77818f87aabb722f2f42b78.png",alt:"Управляемый текстовый документ"}})]),t._v(" "),s("p",[t._v("Вы можете изменить значения, и эти изменения будут применены при следующем запуске.")]),t._v(" "),s("p",[t._v("Включение свойства "),s("code",[t._v("Delete Unused")]),t._v(" приведет к удалению записей в управляемых текстовых документах, на которые нет прямых ссылок ни через компоненты "),s("code",[t._v("ManagedTextProvider")]),t._v(", ни через атрибуты "),s("code",[t._v("ManagedText")]),t._v(" в исходном коде (подробнее об этом ниже).")]),t._v(" "),s("h2",{attrs:{id:"провайдер-управnяемого-текста"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#провайдер-управnяемого-текста"}},[t._v("#")]),t._v(" Провайдер управляемого текста")]),t._v(" "),s("p",[t._v("Возможна привязка произвольного игрового объекта Unity к управляемой текстовой записи без каких-либо скриптов с помощью компонента "),s("code",[t._v("ManagedTextProvider")]),t._v("; добавьте компонент к игровому объекту, укажите категорию (имя документа, который будет содержать запись), ключ (имя записи внутри документа), затем используйте событие "),s("code",[t._v("OnValueChanged")]),t._v(" для привязки значения к свойству игрового объекта.")]),t._v(" "),s("p",[t._v('Ниже приведен пример привязки управляемой текстовой записи, хранящейся в документе "MyCustomDocument", с ключом "MyCustomText" к компоненту Unity "Text".')]),t._v(" "),s("p",[s("img",{attrs:{src:"https://i.gyazo.com/f47a997052674341aa3133deeea1f1cf.png",alt:""}})]),t._v(" "),s("p",[t._v("Если компонент "),s("code",[t._v("ManagedTextProvider")]),t._v(" используется в пользовательском UI, текстовом принтере или обработчике выбора, соответствующие записи будут автоматически сгенерированы при использовании инструмента для управляемого текста (учитывая, что ресурсы назначены в меню конфигурации); в других случаях вам придется добавлять записи вручную.")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://i.gyazo.com/cc2ad398d1ad716cca437913553eb09c.png",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"переменные-управnяемого-текста"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#переменные-управnяемого-текста"}},[t._v("#")]),t._v(" Переменные управляемого текста")]),t._v(" "),s("p",[t._v("Также возможно связать управляемые текстовые записи с переменными в исходном коде. Для этого необходимо добавить атрибут "),s("code",[t._v("ManagedText")]),t._v(" для статичного строкового поля в скрипте на C#. Его значение будет перезаписано значением, указанным в управляемом текстовом документе при инициализации движка.")]),t._v(" "),s("p",[t._v("Ниже приведен пример использования управляемой текстовой переменной для локализации текстовой метки в скрипте C#.")]),t._v(" "),s("div",{staticClass:"language-csharp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("Naninovel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("UnityEngine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UI")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Наследуем наш класс от текстового компонента Unity, так что мы можем использовать его таким же образом.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CustomLabel")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token type-list"}},[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Text")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Значение управляемой текстовой записи "CustomLabel.LabelText" будет присвоено ')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// приведенной ниже переменной при инициализации движка и обновлении при изменении локали.")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token attribute"}},[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ManagedText")]),s("span",{pre:!0,attrs:{class:"token attribute-arguments"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MyCustomUI"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// "MyCustomUI" – имя управляемого текстового документа, в котором будет храниться запись.')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")])]),t._v(" LabelText "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Default Value"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// "Default Value" – исходное значение записи.')]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("override")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token return-type class-name"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")])]),t._v(" Awake "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("base")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Awake")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" LabelText"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Присвоить метке текущее значение управляемой текстовой записи.")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Обновить метку, когда пользователь меняет локаль в процессе выполнения.")]),t._v("\n        Engine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token generic-method"}},[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetService")]),s("span",{pre:!0,attrs:{class:"token generic class-name"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ILocalizationManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OnLocaleChanged "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" _ "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" LabelText"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"текст-сценариев"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#текст-сценариев"}},[t._v("#")]),t._v(" Текст сценариев")]),t._v(" "),s("p",[t._v("Можно получать управляемые текстовые значения непосредственно из сценариев Naninovel. Это может быть удобно, когда требуется использовать некоторый текст в выражениях скриптов, и текст должен быть локализуемым.")]),t._v(" "),s("p",[t._v('Создайте управляемый текстовый документ с именем "Script" и добавьте записи, используя ключи с префиксом '),s("code",[t._v("T_")]),t._v(" или "),s("code",[t._v("t_")]),t._v('. Теперь можно ссылаться на значения в выражениях скрипта; например, учитывая следующие записи в управляемом текстовом документе "Script":')]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("T_Greeting1: Hey!\nT_Greeting2: Hello!\nT_Greeting3: Hi!\n")])])]),s("p",[t._v("— вы можете сослаться на данные значения следующим образом:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("@print {Random(T_Greeting1,T_Greeting2,T_Greeting3)}\n")])])]),s("p",[t._v('Конечно, управляемый текстовый документ "Script" может быть локализован так же, как и другие документы; поэтому, когда пользователь выберет другую локаль, на текст автоматически будет ссылаться соответствующий локализованный документ.')]),t._v(" "),s("h2",{attrs:{id:"локаnизация"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#локаnизация"}},[t._v("#")]),t._v(" Локализация")]),t._v(" "),s("p",[t._v("Процесс локализации управляемого текста похож на процесс локализации сценариев Naninovel:")]),t._v(" "),s("ol",[s("li",[t._v("Сгенерируйте (создайте, отредактируйте) необходимые управляемые текстовые документы в папке "),s("code",[t._v("Resources/Naninovel/Text")]),t._v(".")]),t._v(" "),s("li",[t._v("Запустите программу локализации в папке локали ("),s("code",[t._v("Resources/Naninovel/Localization/{Locale}")]),t._v(", где "),s("code",[t._v("{Locale}")]),t._v(" – тег целевой локали).")]),t._v(" "),s("li",[t._v("Документы локализации для исходных управляемых текстовых документов появятся в соответствующей папке локали. Используйте их для добавления или редактирования перевода.")])]),t._v(" "),s("p",[t._v("Чтобы обновить управляемые текстовые документы и их соответствующие аналоги в локалях, сначала запустите утилиту создания управляемого текста в папке "),s("code",[t._v("Resources/Naninovel/Text")]),t._v(", а затем утилиту локализации в папке "),s("code",[t._v("Resources/Naninovel/Localization/{Locale}")]),t._v(". Обе утилиты по умолчанию будут пытаться сохранить все существующие модификации (управляемые текстовые записи и их переводы), так что вам не придется переписывать все с нуля при каждом обновлении.")]),t._v(" "),s("p",[t._v("См. "),s("RouterLink",{attrs:{to:"/ru/guide/localization.html"}},[t._v("локализацию")]),t._v(" для дополнительной информации о том, как использовать утилиту локализации.")],1),t._v(" "),s("div",{staticClass:"custom-block example"},[s("p",{staticClass:"custom-block-title"},[t._v("ПРИМЕР")]),t._v(" "),s("p",[t._v("Пример настройки локализации (включая управляемый текст) вы можете найти в "),s("RouterLink",{attrs:{to:"/ru/guide/getting-started.html#demo-project"}},[t._v("демо-проекте")]),t._v(". Вы можете использовать его в качестве референса в случае возникновения проблем с настройкой локализации в вашем собственном проекте.")],1)])])}),[],!1,null,null,null);a.default=n.exports}}]);