(window.webpackJsonp=window.webpackJsonp||[]).push([[118],{396:function(a,s,t){"use strict";t.r(s);var e=t(42),r=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"поnьзоватеnьские-переменные"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#поnьзоватеnьские-переменные"}},[a._v("#")]),a._v(" Пользовательские переменные")]),a._v(" "),t("p",[a._v("Функция пользовательских переменных позволяет создавать специализированные переменные, изменять и использовать их для управления условным выполнением сценариев Naninovel или других систем. Например, пользовательские переменные могут использоваться для выбора одного из нескольких сценариев Naninovel для воспроизведения (руты сценариев), основанных на решениях, принятых игроком в прошлом. Другой часто используемый сценарий – это экран статистики игрока (например, результаты, деньги, ресурсы и т.д.), основанный на выборах, которые игрок совершает на протяжении всей игры.")]),a._v(" "),t("p",[a._v("Пользовательские переменные могут быть созданы, изменены и использованы в сценариях Naninovel через команды "),t("a",{attrs:{href:"/api/#set",target:"_blank"}},[t("code",[a._v("@set")])]),a._v(" и "),t("a",{attrs:{href:"/api/#if",target:"_blank"}},[t("code",[a._v("@if")])]),a._v(" команды и в скриптах C# с помощью "),t("RouterLink",{attrs:{to:"/ru/guide/engine-services.html"}},[a._v("сервиса движка")]),a._v(" "),t("code",[a._v("ICustomVariableManager")]),a._v(".")],1),a._v(" "),t("p",[a._v("Например, следующая команда сценария присвоит пользовательской переменной "),t("code",[a._v("score")]),a._v(" значение в зависимости от выбора игрока:")]),a._v(" "),t("div",{staticClass:"language-nani extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nani"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@choice")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token quoted-string operator"}},[a._v('"I\'m humble, one is enough..."')]),t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" set:")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("score=1")])])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@choice")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token quoted-string operator"}},[a._v('"Two, please."')]),t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" set:")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("score=2")])])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@choice")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token quoted-string operator"}},[a._v('"I\'ll take your entire stock!"')]),t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" set:")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("score=999")])])]),a._v("\n")])])]),t("p",[a._v("А следующая будет перенаправлять выполнение сценария на основе значения переменной "),t("code",[a._v("score")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-nani extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nani"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@goto")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("MainRoute")]),t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" if:")]),t("span",{pre:!0,attrs:{class:"token quoted-string operator"}},[a._v('"score > 1 && score <= 900"')])])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@goto")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("BadEnd")]),t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" if:")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("score>900")])])]),a._v("\n")])])]),t("p",[a._v("Дополнительные примеры см. в справочнике API по командам "),t("a",{attrs:{href:"/ru/api/#set",target:"_blank"}},[t("code",[a._v("@set")])]),a._v(" и "),t("a",{attrs:{href:"/ru/api/#if",target:"_blank"}},[t("code",[a._v("@if")])]),a._v(".")]),a._v(" "),t("p",[a._v("Все пользовательские переменные автоматически сохраняются вместе с игрой. По умолчанию переменные хранятся в "),t("strong",[a._v("локальной области")]),a._v(". Это означает, что если вы назначите какую–то переменную в ходе игрового процесса, а после игрок начнет новую игру или загрузит другой сохраненный игровой слот, где эта переменная не была назначена – значение будет потеряно. Это используется для большинства типов переменных. Однако если вы хотите сохранить переменную в "),t("strong",[a._v("глобальной области")]),a._v(", добавьте к ее имени "),t("code",[a._v("G_")]),a._v(" или "),t("code",[a._v("g_")]),a._v(", например: "),t("code",[a._v("G_FinishedMainRoute")]),a._v(" или "),t("code",[a._v("g_total_score")]),a._v(". Глобальные переменные могут использоваться для указания некоторой общей информации, например, количества раз, когда игрок закончил какой-то рут, или общего счёта, основанного на всех прохождениях игры.")]),a._v(" "),t("p",[a._v('Вы можете установить предварительно определенные пользовательские переменные (как глобальные, так и локальные) с начальными значениями в меню конфигурации "Custom Variables".')]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.gyazo.com/21701f17403921e34ba4da33b0261ad0.png",alt:""}})]),a._v(" "),t("p",[a._v("Глобальные предопределенные переменные инициализируются при первом запуске приложения, в то время как локальные делают это при каждом сбросе состояния. Обратите внимание, что поле значения в меню ожидает допустимое выражение сценария, а не необработанную строку значения.")]),a._v(" "),t("h2",{attrs:{id:"внедрение-переменных"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#внедрение-переменных"}},[a._v("#")]),a._v(" Внедрение переменных")]),a._v(" "),t("p",[a._v("Можно внедрить (встроить) пользовательскую переменную в значения параметров сценария Naninovel, используя фигурные скобки.")]),a._v(" "),t("p",[a._v("Следующий скрипт покажет интерфейс поля ввода, где пользователь сможет ввести произвольный текст. После введения введенный текст будет присвоен указанной пользовательской переменной.")]),a._v(" "),t("div",{staticClass:"language-nani extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nani"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("; Разрешить пользователю ввести произвольный текст и назначить его пользовательской переменной состояния `name`.")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@input")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" summary:")]),t("span",{pre:!0,attrs:{class:"token quoted-string operator"}},[a._v('"Choose your name."')])])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("; Команда Stop необходима для остановки выполнения скрипта до тех пор, пока пользователь не отправит вводимые данные.")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@stop")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("; Теперь можно ввести назначенную переменную `name` в сценарии Naninovel…")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token generic-text punctuation"}},[a._v("Archibald: Greetings, "),t("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{name}")]),a._v("!")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token generic-text punctuation"}},[t("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{name}")]),a._v(": Yo!")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("; … или используйте её внутри набора и условных выражений.")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@set")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("score=score+1")]),t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" if:")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("name==")]),t("span",{pre:!0,attrs:{class:"token quoted-string operator"}},[a._v('"Felix"')])])]),a._v("\n")])])]),t("p",[a._v("Вы можете вводить пользовательские переменные в любые значения параметров, если это позволяет тип. Например, вы не можете назначить строку (текст) целочисленному параметру (числу).")]),a._v(" "),t("div",{staticClass:"language-nani extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nani"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@set")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v('PlayerName="Felix";PlayerYPosition=0.1;PlayerTint="lightblue"')])])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("; Следующее выражение вызовет ошибку, так как `PlayerTint` не является числом…")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@char")]),t("span",{pre:!0,attrs:{class:"token whitespaces"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{PlayerName}")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" pos:")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("50,")])]),t("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{PlayerTint}")]),t("span",{pre:!0,attrs:{class:"token whitespaces"}},[a._v(" ")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("; … а это будет выполнено корректно..")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@char")]),t("span",{pre:!0,attrs:{class:"token whitespaces"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{PlayerName}")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" pos:")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("50,")])]),t("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{PlayerYPosition}")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" tint:")])]),t("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{PlayerTint}")])]),a._v("\n")])])]),t("h2",{attrs:{id:"переменные-триггеры"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#переменные-триггеры"}},[a._v("#")]),a._v(" Переменные триггеры")]),a._v(" "),t("p",[a._v("При создании "),t("RouterLink",{attrs:{to:"/ru/guide/user-interface.html#кастомизация-UI"}},[a._v("пользовательского интерфейса")]),a._v(" или других систем вам может потребоваться реагирование событий на изменения значений переменных. Например, при построении экрана статистики персонажей вы хотите, чтобы текст изменялся вслед за переменными. Хотя обычным способом реализации такого поведения было бы использование скрипта C#, вы также можете использовать компонент "),t("code",[a._v("Custom Variable Trigger")]),a._v(". Компонент будет вызывать события Unity при изменении переменной с указанным именем. Вы можете связать совместимые команды с определёнными событиями, такими как обновление текстовых значений.")],1),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.gyazo.com/22eddd109e76d4e63c461e9d75b20ceb.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"отnадка-переменных"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#отnадка-переменных"}},[a._v("#")]),a._v(" Отладка переменных")]),a._v(" "),t("p",[a._v("Во время воспроизведения игры можно просматривать все существующие переменные и изменять их значения в целях отладки.")]),a._v(" "),t("p",[a._v("Откройте "),t("RouterLink",{attrs:{to:"/ru/guide/development-console.html"}},[a._v("консоль разработчика")]),a._v(" и введите команду "),t("code",[a._v("var")]),a._v(", чтобы открыть окно редактора переменных.")],1),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.gyazo.com/d1812668c0776b01f3a82c5ddcba0145.png",alt:""}})]),a._v(" "),t("p",[a._v('При изменении значения переменной в списке появится кнопка "SET", которую можно нажать, чтобы применить изменения.')]),a._v(" "),t("p",[a._v("Список переменных автоматически обновляется при изменении пользовательских переменных во время воспроизведения.")])])}),[],!1,null,null,null);s.default=r.exports}}]);