(window.webpackJsonp=window.webpackJsonp||[]).push([[166],{493:function(a,s,t){"use strict";t.r(s);var e=t(42),r=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"自定义变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自定义变量"}},[a._v("#")]),a._v(" 自定义变量")]),a._v(" "),t("p",[a._v("自定义变量特性允许用户创建用户指定的变量，使用他们来驱动特定条件下的Naninovel脚本或其他系统执行。比如，自定义变量可以用于选择多个Naninovel脚本中的某一个执行（预设路线），基于用户之前的选择。另一个频繁使用的场景，玩家状态画面（比如，分数，金钱，资源等），基于玩家的游戏中的选择执行操作。")]),a._v(" "),t("p",[a._v("自定义变量可以自己创建，定制并用于Naninovel脚本中的 "),t("a",{attrs:{href:"/api/#set",target:"_blank"}},[t("code",[a._v("@set")])]),a._v(" 和 "),t("a",{attrs:{href:"/api/#if",target:"_blank"}},[t("code",[a._v("@if")])]),a._v(" 命令，及C#脚本中的"),t("code",[a._v("ICustomVariableManager")]),a._v(" "),t("RouterLink",{attrs:{to:"/zh/guide/engine-services.html"}},[a._v("引擎服务")]),a._v(" 。")],1),a._v(" "),t("p",[a._v("比如，以下脚本命令将会根据选择为自定义变量 "),t("code",[a._v("score")]),a._v(" 赋予不同值：")]),a._v(" "),t("div",{staticClass:"language-nani extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nani"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@choice")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token quoted-string operator"}},[a._v('"I\'m humble, one is enough..."')]),t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" set:")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("score=1")])])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@choice")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token quoted-string operator"}},[a._v('"Two, please."')]),t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" set:")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("score=2")])])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@choice")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token quoted-string operator"}},[a._v('"I\'ll take your entire stock!"')]),t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" set:")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("score=999")])])]),a._v("\n")])])]),t("p",[a._v("以下脚本将会根据 "),t("code",[a._v("score")]),a._v(" 值决定脚本执行路线：")]),a._v(" "),t("div",{staticClass:"language-nani extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nani"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@goto")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("MainRoute")]),t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" if:")]),t("span",{pre:!0,attrs:{class:"token quoted-string operator"}},[a._v('"score > 1 && score <= 900"')])])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@goto")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("BadEnd")]),t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" if:")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("score>900")])])]),a._v("\n")])])]),t("p",[a._v("察看API参考部分获取更多关于 "),t("a",{attrs:{href:"/zh/api/#set",target:"_blank"}},[t("code",[a._v("@set")])]),a._v(" 和 "),t("a",{attrs:{href:"/zh/api/#if",target:"_blank"}},[t("code",[a._v("@if")])]),a._v(" 命令的示例。")]),a._v(" "),t("p",[a._v("所有自定义变量都随游戏自动保存。默认情况下，变量存储于"),t("strong",[a._v("局部范围")]),a._v("中。意味着，在游戏中你注册了某些变量值后，玩家重新开始新游戏或加载了其他栏位的游戏后，该值会丢失。大多数变量适用于此情况。如果，你希望将该变量存储于 "),t("strong",[a._v("全局范围")]),a._v(" ，在其变量名加上 "),t("code",[a._v("G_")]),a._v(" 或 "),t("code",[a._v("g_")]),a._v(" ，比如"),t("code",[a._v("G_FinishedMainRoute")]),a._v(" 或 "),t("code",[a._v("g_total_score")]),a._v("。全局变量可以用于表明部分元信息或总信息，比如，玩家完成某些路线的次数，或所有路线中的总分数。")]),a._v(" "),t("p",[a._v('在配置菜单的 "Custom Variables" 中，你可以为自定义变量（全局和局部范围）预先设置初始值。')]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.gyazo.com/21701f17403921e34ba4da33b0261ad0.png",alt:""}})]),a._v(" "),t("p",[a._v("全局预定义值将会随第一个应用启动时初始化，本地变量会在每次状态重置时初始化。请注意，菜单中的value字段需要有效的脚本表达式，而不是原始值字符串。")]),a._v(" "),t("h2",{attrs:{id:"注入变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注入变量"}},[a._v("#")]),a._v(" 注入变量")]),a._v(" "),t("p",[a._v("可以使用花括号将自定义变量注入（内联）到naninovel脚本参数值。")]),a._v(" "),t("p",[a._v("以下脚本将显示一个输入字段UI，用户可以在其中输入任意文本。提交后，输入的文本将分配给指定的自定义变量。")]),a._v(" "),t("div",{staticClass:"language-nani extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nani"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("; 允许玩家输入任意文本，并绑定到 `name` 自定义变量。")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@input")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" summary:")]),t("span",{pre:!0,attrs:{class:"token quoted-string operator"}},[a._v('"Choose your name."')])])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("; 停止命令，挂起脚本直到玩家提交输入值。")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@stop")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("; 之后你就可以Naninovel脚本中注入该 `name` 变量值。")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token generic-text punctuation"}},[a._v("Archibald: Greetings, "),t("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{name}")]),a._v("!")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token generic-text punctuation"}},[t("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{name}")]),a._v(": Yo!")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("; ...或在set命令的条件表达式中使用。")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@set")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("score=score+1")]),t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" if:")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("name==")]),t("span",{pre:!0,attrs:{class:"token quoted-string operator"}},[a._v('"Felix"')])])]),a._v("\n")])])]),t("p",[a._v("只要类型允许，就可以将自定义变量注入任何参数值。例如，不能将字符串（文本）分配给整数（数字）参数。")]),a._v(" "),t("div",{staticClass:"language-nani extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nani"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@set")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v('PlayerName="Felix";PlayerYPosition=0.1;PlayerTint="lightblue"')])])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("; 由于 `PlayerTint` 值不是数字，所以会报错。")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@char")]),t("span",{pre:!0,attrs:{class:"token whitespaces"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{PlayerName}")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" pos:")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("50,")])]),t("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{PlayerTint}")]),t("span",{pre:!0,attrs:{class:"token whitespaces"}},[a._v(" ")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("; ...这句会正常执行。")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token command function"}},[t("span",{pre:!0,attrs:{class:"token command-name"}},[a._v("@char")]),t("span",{pre:!0,attrs:{class:"token whitespaces"}},[a._v(" ")]),t("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{PlayerName}")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" pos:")]),t("span",{pre:!0,attrs:{class:"token command-param-value operator"}},[a._v("50,")])]),t("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{PlayerYPosition}")]),t("span",{pre:!0,attrs:{class:"token command-params"}},[t("span",{pre:!0,attrs:{class:"token command-param-id property"}},[a._v(" tint:")])]),t("span",{pre:!0,attrs:{class:"token expression selector"}},[a._v("{PlayerTint}")])]),a._v("\n")])])]),t("h2",{attrs:{id:"变量触发器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#变量触发器"}},[a._v("#")]),a._v(" 变量触发器")]),a._v(" "),t("p",[a._v("在构建 "),t("RouterLink",{attrs:{to:"/zh/guide/user-interface.html#UI自定义"}},[a._v("自定义UI")]),a._v(" 或其他系统时，可能希望在变量值更改时侦听（反应）事件。比如创建，角色状态界面是，你想让文本跟随变量改变。使用条件判断实现应该会用到C#脚本，你也可以通过 "),t("code",[a._v("Custom Variable Trigger")]),a._v(" 组件使用达到效果。当给定名字的变量值改变时，该组件会调用Unity事件。你可以将事件和合适命令绑定，比如更新文本值。")],1),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.gyazo.com/22eddd109e76d4e63c461e9d75b20ceb.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"变量debug"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#变量debug"}},[a._v("#")]),a._v(" 变量debug")]),a._v(" "),t("p",[a._v("在游戏运行时，可以基于debug的目的查看和修改所有已有变量值。")]),a._v(" "),t("p",[a._v("打开"),t("RouterLink",{attrs:{to:"/zh/guide/development-console.html"}},[a._v("开发控制台")]),a._v(" ，输入命令，打开 "),t("code",[a._v("var")]),a._v(" 变量编辑窗口。")],1),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.gyazo.com/d1812668c0776b01f3a82c5ddcba0145.png",alt:""}})]),a._v(" "),t("p",[a._v("当改变列表中的值后，“set”按钮会出现，点击后应用该修改。")]),a._v(" "),t("p",[a._v("如果游戏运行中变量值改变，变量列表会自动更新对应值。")])])}),[],!1,null,null,null);s.default=r.exports}}]);